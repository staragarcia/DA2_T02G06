\doxysection{ilp.\+cpp}
\hypertarget{ilp_8cpp_source}{}\label{ilp_8cpp_source}\index{algorithms/ilp.cpp@{algorithms/ilp.cpp}}
\mbox{\hyperlink{ilp_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}ortools/linear\_solver/linear\_solver.h"{}}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ "{}../utils/structs.h"{}}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00018\ std::vector<Pallet>\ \mbox{\hyperlink{ilp_8cpp_a8aaa31c00bfd265d2e8d6a7794c779df}{SolveKnapsackILP}}(\mbox{\hyperlink{structDataset}{Dataset}}\&\ dataset,\ \textcolor{keywordtype}{int}\ \&totalWeight,\ \textcolor{keywordtype}{int}\ \&totalProfit)\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordtype}{double}\ epsilon\ =\ 1e-\/6;}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_items\ =\ dataset.\mbox{\hyperlink{structDataset_a96c8bb1fafab976e0b57998166fe012f}{pallets}}.size();}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//\ Create\ the\ MIP\ solver\ with\ the\ CBC\ backend.}}
\DoxyCodeLine{00023\ \ \ \ \ operations\_research::MPSolver\ solver(\textcolor{stringliteral}{"{}KnapsackILP"{}},\ operations\_research::MPSolver::CBC\_MIXED\_INTEGER\_PROGRAMMING);}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{comment}{//\ Define\ decision\ variables:\ x[i]\ =\ 1\ if\ item\ i\ is\ included,\ 0\ otherwise.}}
\DoxyCodeLine{00026\ \ \ \ \ std::vector<const\ operations\_research::MPVariable*>\ x(num\_items);}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_items;\ ++i)\ \{}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ x[i]\ =\ solver.MakeIntVar(0,\ 1,\ \textcolor{stringliteral}{"{}x\_"{}}\ +\ std::to\_string(i));}
\DoxyCodeLine{00029\ \ \ \ \ \}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{//\ Add\ the\ capacity\ constraint:\ sum(weights[i]\ *\ x[i])\ <=\ capacity}}
\DoxyCodeLine{00032\ \ \ \ \ operations\_research::MPConstraint*\ capacity\_constraint\ =\ solver.MakeRowConstraint(0,\ dataset.\mbox{\hyperlink{structDataset_adebfd043d4578ea89aae0edeb793fb61}{truckCapacity}},\ \textcolor{stringliteral}{"{}capacity"{}});}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_items;\ ++i)\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ capacity\_constraint-\/>SetCoefficient(x[i],\ dataset.\mbox{\hyperlink{structDataset_a96c8bb1fafab976e0b57998166fe012f}{pallets}}[i].weight);}
\DoxyCodeLine{00035\ \ \ \ \ \}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{comment}{//\ Define\ the\ objective:\ maximize\ sum(values[i]\ *\ x[i])}}
\DoxyCodeLine{00038\ \ \ \ \ operations\_research::MPObjective*\ objective\ =\ solver.MutableObjective();}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_items;\ ++i)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ objective-\/>SetCoefficient(x[i],\ dataset.\mbox{\hyperlink{structDataset_a96c8bb1fafab976e0b57998166fe012f}{pallets}}[i].profit\ -\/\ epsilon);}
\DoxyCodeLine{00041\ \ \ \ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ objective-\/>SetMaximization();}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{const}\ operations\_research::MPSolver::ResultStatus\ result\_status\ =\ solver.Solve();}
\DoxyCodeLine{00045\ \ \ \ \ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\_status\ ==\ operations\_research::MPSolver::OPTIMAL)\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ std::vector<Pallet>\ selectedPallets;}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ totalProfit\ =\ 0;}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ totalWeight\ =\ 0;}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_items;\ ++i)\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x[i]-\/>solution\_value()\ ==\ 1)\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ totalProfit\ +=\ dataset.\mbox{\hyperlink{structDataset_a96c8bb1fafab976e0b57998166fe012f}{pallets}}[i].profit;}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ totalWeight\ +=\ dataset.\mbox{\hyperlink{structDataset_a96c8bb1fafab976e0b57998166fe012f}{pallets}}[i].weight;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ selectedPallets.emplace\_back(dataset.\mbox{\hyperlink{structDataset_a96c8bb1fafab976e0b57998166fe012f}{pallets}}[i]);}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ selectedPallets;}
\DoxyCodeLine{00058\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ totalProfit\ =\ 0;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ totalWeight\ =\ 0;}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\};}
\DoxyCodeLine{00062\ \ \ \ \ \}}
\DoxyCodeLine{00063\ \}}

\end{DoxyCode}
